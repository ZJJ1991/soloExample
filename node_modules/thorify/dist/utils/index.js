'use strict';
function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
const web3Utils = require('web3-utils');
const params_1 = require("./params");
__export(require("./params"));
__export(require("./option-formatters"));
exports.calcIntrinsicGas = function (tx) {
    let totalGas = params_1.params.TxGas;
    // calculate data gas
    if (tx.data) {
        const buffer = new Buffer(exports.sanitizeHex(tx.data), 'hex');
        let z = 0;
        let nz = 0;
        for (const byte of buffer) {
            if (byte) {
                nz++;
            }
            else {
                z++;
            }
        }
        totalGas += params_1.params.TxDataZeroGas * z;
        totalGas += params_1.params.TxDataNonZeroGas * nz;
    }
    if (!!tx.to) {
        totalGas += params_1.params.ClauseGas;
    }
    else {
        totalGas += params_1.params.ClauseGasContractCreation;
    }
    return totalGas;
};
exports.toPrefixedHex = function (hexStr) {
    if (hexStr.indexOf('0x') === 0) {
        return hexStr;
    }
    else {
        return '0x' + hexStr;
    }
};
exports.sanitizeHex = function (hexStr) {
    if (hexStr.indexOf('0x') === 0) {
        return hexStr.substr(2);
    }
    else {
        return hexStr;
    }
};
exports.isHex = function (hex) {
    return !!hex && ((typeof hex === 'string') && /^(-0x|0x)?[0-9a-f]+$/i.test(hex));
};
exports.newNonce = function () {
    return Math.floor((new Date().getTime() / 0xffff) * Math.random() * 0xffff);
};
exports.toInteger = function (input) {
    const num = Number.parseInt(input);
    if (Number.isInteger(num)) {
        return num;
    }
    else {
        return null;
    }
};
exports.isArray = function (o) {
    return Object.prototype.toString.call(o) === '[object Array]';
};
exports.isObject = function (o) {
    return Object.prototype.toString.call(o) === '[object Object]';
};
exports.isNull = function (o) {
    return Object.prototype.toString.call(o) === '[object Null]';
};
exports.isUndefined = function (o) {
    return Object.prototype.toString.call(o) === '[object Undefined]';
};
exports.isFunction = function (o) {
    return typeof o === 'function';
};
exports.mustToBN = function (value) {
    if (exports.isNull(value) || exports.isUndefined(value)) {
        throw new Error('input can\'t be null or undefined');
    }
    const num = web3Utils.toBN(value);
    return num.abs();
};
exports.validNumberOrDefault = function (value, defaultValue) {
    if (typeof value === 'number' && Number.isInteger(value)) {
        return Math.abs(value);
    }
    if (Number.isNaN(Number.parseInt(value)) === false) {
        return Math.abs(Number.parseInt(value));
    }
    return defaultValue;
};
exports.validAddressOrError = function (input, msg = 'Invalid address string') {
    if (/^(-0x|0x)?[0-9a-fA-F]{40}$/i.test(input)) {
        return exports.toPrefixedHex(input);
    }
    else {
        throw new Error(msg);
    }
};
exports.validBytes32OrError = function (input, msg = 'Invalid hex string') {
    if (/^(-0x|0x)?[0-9a-fA-F]{64}$/i.test(input)) {
        return exports.toPrefixedHex(input);
    }
    else {
        throw new Error(msg);
    }
};
exports.leftPadToBytes32 = function (input) {
    return ('0x' + '0'.repeat(64 - exports.sanitizeHex(input).length) + exports.sanitizeHex(input));
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdXRpbHMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWSxDQUFBOzs7OztBQUNaLE1BQU0sU0FBUyxHQUFHLE9BQU8sQ0FBQyxZQUFZLENBQUMsQ0FBQTtBQUV2QyxxQ0FBaUM7QUFFakMsOEJBQXdCO0FBQ3hCLHlDQUFtQztBQUV0QixRQUFBLGdCQUFnQixHQUFHLFVBQVMsRUFBa0I7SUFDdkQsSUFBSSxRQUFRLEdBQUcsZUFBTSxDQUFDLEtBQUssQ0FBQTtJQUUzQixxQkFBcUI7SUFDckIsSUFBSSxFQUFFLENBQUMsSUFBSSxFQUFFO1FBQ1QsTUFBTSxNQUFNLEdBQUcsSUFBSSxNQUFNLENBQUMsbUJBQVcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUE7UUFDdEQsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQ1QsSUFBSSxFQUFFLEdBQUcsQ0FBQyxDQUFBO1FBQ1YsS0FBSyxNQUFNLElBQUksSUFBSSxNQUFNLEVBQUU7WUFDdkIsSUFBSSxJQUFJLEVBQUU7Z0JBQ04sRUFBRSxFQUFFLENBQUE7YUFDUDtpQkFBTTtnQkFDSCxDQUFDLEVBQUUsQ0FBQTthQUNOO1NBQ0o7UUFDRCxRQUFRLElBQUksZUFBTSxDQUFDLGFBQWEsR0FBRyxDQUFDLENBQUE7UUFDcEMsUUFBUSxJQUFJLGVBQU0sQ0FBQyxnQkFBZ0IsR0FBRyxFQUFFLENBQUE7S0FDM0M7SUFFRCxJQUFJLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFO1FBQ1QsUUFBUSxJQUFJLGVBQU0sQ0FBQyxTQUFTLENBQUE7S0FDL0I7U0FBTTtRQUNILFFBQVEsSUFBSSxlQUFNLENBQUMseUJBQXlCLENBQUE7S0FDL0M7SUFFRCxPQUFPLFFBQVEsQ0FBQTtBQUNuQixDQUFDLENBQUE7QUFFWSxRQUFBLGFBQWEsR0FBRyxVQUFTLE1BQWM7SUFDaEQsSUFB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